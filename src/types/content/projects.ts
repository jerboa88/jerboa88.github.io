/**
 * Type definitions for projects and project configs
 */

import type { DateString, SentenceString, UrlString } from '../strings.ts';
import type { Overwrite } from '../utils.ts';

/**
 * An enumeration of possible project types
 *
 * @enum {number}
 */
export enum ProjectType {
	Other = 0,
	GithubRepo = 1,
}

/**
 * Possible project categories
 */
export enum ProjectCategory {
	App = 'App',
	Container = 'Container',
	Document = 'Document',
	Extension = 'Extension',
	Library = 'Library',
	Other = 'Other',
	Plugin = 'Plugin',
	Script = 'Script',
	Website = 'Website',
}

export enum SchemaType {
	Mobile = 'MobileApplication',
	Software = 'SoftwareApplication',
	Web = 'WebApplication',
}

export enum SchemaApplicationCategory {
	Browser = 'BrowserApplication',
	Business = 'BusinessApplication',
	Communication = 'CommunicationApplication',
	Design = 'DesignApplication',
	DesktopEnhancement = 'DesktopEnhancementApplication',
	Developer = 'DeveloperApplication',
	Driver = 'DriverApplication',
	Educational = 'EducationalApplication',
	Entertainment = 'EntertainmentApplication',
	Finance = 'FinanceApplication',
	Game = 'GameApplication',
	Health = 'HealthApplication',
	Home = 'HomeApplication',
	Lifestyle = 'LifestyleApplication',
	Multimedia = 'MultimediaApplication',
	Reference = 'ReferenceApplication',
	Security = 'SecurityApplication',
	Shopping = 'ShoppingApplication',
	SocialNetworking = 'SocialNetworkingApplication',
	Sports = 'SportsApplication',
	Travel = 'TravelApplication',
	Utilities = 'UtilitiesApplication',
}

/**
 * A base project with common fields
 *
 * @remarks
 *
 * The fields here must be primitives because they are automatically serialized by Gatsby when passed as props to programmatically generated pages. Making any of these fields an object will break type safety and cause runtime errors.
 *
 * @typeParam T - The type of project
 * @param category.color - The color of the project category
 * @param category.name - The name of the project category (ex. 'Website', 'App', etc.)
 * @param createdAt - The date the project was created
 * @param description - A brief description of the project
 * @param exposition - A longer description of the project,
 * @param languages - A list of programming languages used in the project
 * @param name - The name of the project
 * @param schemaApplicationCategory - The schema.org application category of the project
 * @param schemaOperatingSystem - The schema.org operating system of the project
 * @param schemaType - The schema.org type of the project
 * @param slug - The slug of the project
 * @param stargazerCount - The number of stars the project has
 * @param technologies - A list of technologies used in the project
 * @param tools - A list of tools used in the project
 * @param topics - A list of topics related to the project
 * @param type - The type of project
 * @param updatedAt - The date the project was last updated
 * @param url - The URL of the project
 */
export type BaseProject<T extends ProjectType> = {
	category: {
		color: string;
		name?: ProjectCategory;
	};
	createdAt: DateString;
	description: SentenceString;
	exposition?: SentenceString;
	languages: readonly string[];
	name: string;
	schemaApplicationCategory?: SchemaApplicationCategory;
	schemaOperatingSystem?: string;
	schemaType?: SchemaType;
	slug: string;
	stargazerCount?: number;
	technologies: readonly string[];
	tools: readonly string[];
	topics: readonly string[];
	type: T;
	updatedAt: DateString;
	url?: UrlString;
};

/**
 * A manually added project
 *
 * @remarks
 *
 * This overwrites the {@link BaseProject} type to make existing fields required or to add more
 */
export type OtherProject = Overwrite<
	BaseProject<ProjectType.Other>,
	{
		exposition: SentenceString;
	}
>;

/**
 * A GitHub repo project
 *
 * @remarks
 *
 * This is based on {@link Queries.GithubRepo}, which is autogenerated by Gatsby from the GraphQL schema. It adds additional fields from the {@link BaseProject} type, which are overwritten to make existing fields required or to add more
 */
export type GithubRepoProject = Overwrite<
	Queries.GithubRepo,
	Overwrite<
		BaseProject<ProjectType.GithubRepo>,
		{
			url: UrlString;
		}
	>
>;

/**
 * Union of all project types
 */
export type Project = GithubRepoProject | OtherProject;

/**
 * Config for a manually added project
 */
export type OtherProjectConfig = Overwrite<
	Omit<OtherProject, 'type'>,
	{
		category: ProjectCategory;
	}
>;

/**
 * Config for manually added projects
 */
export type ProjectsConfig = {
	[ProjectType.Other]: OtherProjectConfig[];
};
